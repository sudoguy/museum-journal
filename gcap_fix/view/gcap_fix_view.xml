<?xml version="1.0" encoding="utf-8"?>
<openerp>
    <data>
        <template id="assets_backend" name="tabel assets" inherit_id="web.assets_backend">
            <xpath expr="." position="inside">
                <link rel="stylesheet" href="/gcap_fix/static/src/css/gcap_fix.css"/>
            </xpath>
        </template>

        <!--orders begin-->
        <record id="view_gcap_fix_order_tree" model="ir.ui.view">
            <field name="name">gcap.fix.order.tree</field>
            <field name="model">gcap.fix.order</field>
            <field name="arch" type="xml">
                <tree string="Заказы">
                    <field name="id" string="№ заказа"/>
                    <field name="create_date" string="Дата\время принятия"/>
                    <field name="readydate"/>
                    <field name="issuedate"/>
                    <field name="estimatedreadydate"/>
                    <field name="serialnumber"/>
                    <field name="imei"/>
                    <field name="devmod"/>
                    <field name="pre_price"/>
                    <field name="real_price"/>
                    <field name="client"/>
                    <field name="client_tel_number" string="Номер клиента"/>
                    <field name="state"/>
                    <field name="executive_engineer"/>
                    <field name="fix_type"/>
                </tree>
            </field>
        </record>

        <record id="view_gcap_fix_order_form" model="ir.ui.view">
            <field name="name">gcap.fix.order.form</field>
            <field name="model">gcap.fix.order</field>
            <field name="arch" type="xml">
                <form string="Заказ" version="8.0">
                    <header>
                        <button name="action_received" type="object"
                                string="Принят" groups="gcap_fix.group_gcap_fix_superuser"/>

                        <button name="action_agreement" type="object"
                                string="Согласование" groups="gcap_fix.group_gcap_fix_user,gcap_fix.group_gcap_fix_superuser" states="received"/>

                        <button name="action_parts_w" type="object"
                                string="Ожидание з\ч" groups="gcap_fix.group_gcap_fix_user,gcap_fix.group_gcap_fix_superuser" states="agreement"/>

                        <button name="action_done" type="object"
                                string="Готов" groups="gcap_fix.group_gcap_fix_user,gcap_fix.group_gcap_fix_superuser" states="received,agreement,parts_w"
                                class="oe_highlight"/>

                        <button name="action_issuedwf" type="object"
                                string="Выдан без ремонта" groups="gcap_fix.group_gcap_fix_user,gcap_fix.group_gcap_fix_superuser" states="received,agreement,parts_w"
                                class="oe_highlight"/>

                        <button name="action_issued" type="object"
                                string="Выдан" groups="gcap_fix.group_gcap_fix_user,gcap_fix.group_gcap_fix_superuser" states="done"
                                class="oe_highlight"/>

                        <field name="state" widget="statusbar"/>
                    </header>
                    <sheet>
                        <group col="2" colspan="2">
                            <field name="id" string="№ заказа" readonly="1"/>
                        </group>
                        <group string="Даты\Ответственные" col="4" colspan="2">
                            <field name="create_date" string="Дата\время принятия" readonly="1"/>
                            <field name="create_maker" readonly="1"/>

                            <field name="readydate" readonly="1"/>
                            <field name="ready_maker" readonly="1"/>

                            <field name="issuedate" readonly="1"/>
                            <field name="issue_maker" readonly="1"/>

                            <field name="estimatedreadydate" colspan="4"/>

                            <field name="agreementdate" readonly="1"/>
                            <field name="agreement_maker" readonly="1"/>

                            <field name="parts_wdate" readonly="1"/>
                            <field name="parts_w_maker" readonly="1"/>


                        </group>
                        <group string="Устройство\Ремонт" col="4" colspan="2">
                            <field name="serialnumber"/>
                            <field name="imei"/>
                            <field name="devmod"/>
                            <field name="fix_type"/>
                            <field name="problemdesc" colspan="4"/>
                            <field name="condition" colspan="4"/>
                            <field name="comment" colspan="4"/>
                            <field name="workdesc" colspan="4"/>
                            <field name="executive_engineer"/>
                        </group>
                        <group string="Клиент\Разное" col="4" colspan="2">
                            <field name="client" colspan="4"/>
                            <field name="client_tel_number" colspan="2" string="Номер клиента" readonly="1"/>
                        </group>
                        <group string="Деньги\Гарантия" col="4" colspan="2">
                            <field name="pre_price" colspan="2"/>
                            <field name="real_price" colspan="2"/>
                            <field name="warranty_period"/>
                        </group>
                    </sheet>
                </form>
            </field>
        </record>

        <record id="action_gcap_fix_order" model="ir.actions.act_window">
            <field name="name">Список заказов</field>
            <field name="res_model">gcap.fix.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_order_state_in_work':1}</field>
        </record>

        <record id="action_gcap_fix_order_arc" model="ir.actions.act_window">
            <field name="name">Архив заказов</field>
            <field name="res_model">gcap.fix.order</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
            <field name="context">{'search_default_order_state_archive':1}</field>
        </record>

        <record id="order_view_search" model="ir.ui.view">
            <field name="name">order.search</field>
            <field name="model">gcap.fix.order</field>
            <field name="arch" type="xml">
                <search>
                    <field name="serialnumber"/>
                    <field name="devmod"/>
                    <field name="client"/>
                    <field name="state"/>
                    <field name="executive_engineer"/>
                    <field name="fix_type"/>
                    <field name="imei"/>

                    <filter name="order_state_in_work" string="В работе"
                            domain="['|','|','|',('state', '=', 'received'),('state', '=', 'agreement'),('state', '=', 'parts_w'),('state', '=', 'done')]"/>

                    <filter name="order_state_archive" string="В архиве"
                            domain="['|',('state', '=', 'issuedwf'),('state', '=', 'issued')]"/>

                    <group string="Сгруппировать">
                        <filter name="group_orders_by_fix_type" string="Тип ремонта" context="{'group_by': 'fix_type'}"/>
                        <filter name="group_by_executive_engineer" string="Ответственный инжинер" context="{'group_by': 'executive_engineer'}"/>
                        <filter name="group_prders_by_client" string="Клиент"
                                context="{'group_by': 'client'}"/>
                    </group>
                </search>
            </field>
        </record>
        <!--orders end-->

        <!--devmod begin-->
        <record id="view_gcap_fix_devmod_tree" model="ir.ui.view">
            <field name="name">gcap.fix.devmod.tree</field>
            <field name="model">gcap.fix.devmod</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="manufacturer"/>
                    <field name="model"/>
                    <field name="generation"/>
                </tree>
            </field>
        </record>

        <record id="view_gcap_fix_devmod_form" model="ir.ui.view">
            <field name="name">gcap.fix.devmod.form</field>
            <field name="model">gcap.fix.devmod</field>
            <field name="arch" type="xml">
                <form>
                    <group string="Устройство">
                        <field name="manufacturer"/>
                        <field name="model"/>
                        <field name="generation"/>
                        <field name="order"/>
                    </group>
                </form>
            </field>
        </record>

        <record id="action_gcap_fix_devmod" model="ir.actions.act_window">
            <field name="name">Список устройств</field>
            <field name="res_model">gcap.fix.devmod</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="devmod_view_search" model="ir.ui.view">
            <field name="name">devmod.search</field>
            <field name="model">gcap.fix.devmod</field>
            <field name="arch" type="xml">
                <search>
                    <field name="full_name"/>

                    <group string="Сгруппировать">
                        <filter name="group_devmod_by_manufacturer" string="Производитель" context="{'group_by': 'manufacturer'}"/>
                        <filter name="group_devmod_by_model" string="Модель" context="{'group_by': 'model'}"/>
                    </group>
                </search>
            </field>
        </record>
        <!--devmod end-->

        <!--clients begin-->
        <record id="view_gcap_fix_client_tree" model="ir.ui.view">
            <field name="name">gcap.fix.client.tree</field>
            <field name="model">gcap.fix.client</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="last_name"/>
                    <field name="first_name"/>
                    <field name="middle_name"/>
                    <field name="tel_number"/>
                    <field name="address"/>
                    <field name="organization"/>
                </tree>
            </field>
        </record>

        <record id="view_gcap_fix_client_form" model="ir.ui.view">
            <field name="name">gcap.fix.client.form</field>
            <field name="model">gcap.fix.client</field>
            <field name="arch" type="xml">
                <form string="Данные клиентов">
                    <group>
                    <field name="last_name"/>
                    <field name="first_name"/>
                    <field name="middle_name"/>
                    <field name="organization"/>
                    <field name="tel_number" placeholder="+7(   )-   -  -  "/>
                    <field name="address" placeholder="г.Дефаулт-сити ул.Дефолтавая д.0 кв.0"/>
                    <field name="order" mode="tree"><!--сделать красиво-->
                        <tree>
                            <field name="id" string="№ заказа"/>
                            <field name="create_date" string="Дата принятия"/>
                            <field name="readydate"/>
                            <field name="issuedate"/>
                            <field name="estimatedreadydate"/>
                            <field name="serialnumber"/>
                            <field name="devmod"/>
                            <field name="pre_price"/>
                            <field name="real_price"/>
                            <field name="state"/>
                        </tree>
                    </field>
                    </group>
                </form>
            </field>
        </record>

        <record id="action_gcap_fix_client" model="ir.actions.act_window">
            <field name="name">Список клиентов</field>
            <field name="res_model">gcap.fix.client</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="client_view_search" model="ir.ui.view">
            <field name="name">client.search</field>
            <field name="model">gcap.fix.client</field>
            <field name="arch" type="xml">
                <search>
                    <field name="full_name"/>
                    <field name="tel_number"/>
                    <field name="organization"/>

                    <group string="Сгруппировать">
                        <filter name="group_clients_by_organization" string="Организация" context="{'group_by': 'organization'}"/>
                    </group>
                </search>
            </field>
        </record>
        <!--clients end-->

        <!--employee begin-->
        <record id="view_gcap_fix_employee_tree" model="ir.ui.view">
            <field name="name">gcap.fix.employee.tree</field>
            <field name="model">gcap.fix.employee</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="last_name"/>
                    <field name="first_name"/>
                    <field name="middle_name"/>
                    <field name="position"/>
                </tree>
            </field>
        </record>

        <record id="view_gcap_fix_employee_form" model="ir.ui.view">
            <field name="name">gcap.fix.employee.form</field>
            <field name="model">gcap.fix.employee</field>
            <field name="arch" type="xml">
                <form string="Данные сотрудников">
                    <group>
                    <field name="last_name"/>
                    <field name="first_name"/>
                    <field name="middle_name"/>
                    <field name="position"/>
                    <field name="order_executive_engineer">
                        <tree string="Заказы">
                            <field name="id" string="№ заказа"/>
                            <field name="create_date" string="Дата принятия"/>
                            <field name="readydate"/>
                            <field name="issuedate"/>
                            <field name="estimatedreadydate"/>
                            <field name="serialnumber"/>
                            <field name="devmod"/>
                            <field name="pre_price"/>
                            <field name="real_price"/>
                            <field name="client"/>
                            <field name="client_tel_number" string="Номер клиента"/>
                            <field name="state"/>
                            <field name="fix_type"/>
                        </tree>
                    </field>>
                    </group>
                </form>
            </field>
        </record>

        <record id="action_gcap_fix_employee" model="ir.actions.act_window">
            <field name="name">Список сотрудников</field>
            <field name="res_model">gcap.fix.employee</field>
            <field name="view_type">form</field>
            <field name="view_mode">tree,form</field>
        </record>

        <record id="employee_view_search" model="ir.ui.view">
            <field name="name">employee.search</field>
            <field name="model">gcap.fix.employee</field>
            <field name="arch" type="xml">
                <search>
                    <field name="full_name"/>

                    <group string="Сгруппировать">
                        <filter name="group_employee_by_position" string="Должность" context="{'group_by': 'position'}"/>
                    </group>
                </search>
            </field>
        </record>
        <!--employee end-->
    </data>
</openerp>